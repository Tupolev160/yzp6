!function(){let e=[],t=0,o=0;const n=[],i="./photos/_p",l="LOCAL_CUR_PAGE",r="LOCAL_RANDOM_PAGE",a="LOCAL_DISLOCATE",c="LOCAL_ROTATE180";localStorage.removeItem("LOCAL_RANDOM");const s=function(){return/(Android|Phone|Harmony|hmscore|Pad|iPod|webOS|wOSBrowser|hp-tablet|BlackBerry|SAMSUNG|iOS|Symbian|Nikoa)/gi.test(navigator.userAgent)},d=function(e,t){return Math.round(Math.random()*(t-e)+e)},g=function(e,t){$("main .container")[0].style.setProperty(e,t)},u=function(e,t,o){const n=document.createElement("li");if(n.className="content-item"+t+o,n.key=1*e.p,e.core){const t=new Image;t.src=i+`${e.core}.png`,t.className="img-core",n.appendChild(t)}if(e.origin){const t=new Image;t.src=i+`${e.origin}.png`,t.className="img-origin",n.appendChild(t)}if(e.hc){const t=new Image;t.src=i+`${e.hc}.gif`,t.className="img-hc",n.appendChild(t)}return n},p=function(){let e=document.createDocumentFragment();for(const t of n)e.appendChild(t);const t=$("ul.item-list");t.empty(),t.append(e),e=null,m()},f=function(){$.get({url:"./data-photos.min.json?token="+Math.random(),success:(o,i)=>{if("success"!==i)return A("%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96%E5%A4%B1%E8%B4%A5%EF%BC%81");e=o,t=Math.floor(o.length/2),function(e){if(null==e)return A("%E6%95%B0%E6%8D%AE%E4%B8%BA%E7%A9%BA%EF%BC%8C%E6%97%A0%E9%9C%80%E6%B8%B2%E6%9F%93%EF%BC%81");n.length=0;const t=JSON.parse(localStorage.getItem(a))||!1,o=JSON.parse(localStorage.getItem(c))||!1;if(o)for(let t=0;t<e.length;t+=2){const o=e[t],n=e[1+t];e[t]=n,e[t+1]=o}const i=o?" rotate180":"",l=o?" posi-down":" posi-up";n.push(u({p:-1},i,l));for(let t=0;t<e.length;t++){const o=e[t],r=1*o.num;o.core=1&r?o.p+"-core-"+o.id:null,o.origin=4&r?o.p+"-origin-"+o.id:null,o.hc=2&r?o.p+"-highContrast-"+o.id:null,o.traitMaker=8&r?o.p+"-trait-"+o.id:null;const a=u(o,i,l);n.push(a)}n.push(u({p:e.length},i,l)),t&&h(),p()}(o)},dataType:"json"})},m=function(){const e=JSON.parse(localStorage.getItem(a))||!1,n=JSON.parse(localStorage.getItem(r))||!1;o=e?0:JSON.parse(localStorage.getItem(l))||0,o=!0===n?d(0,t):o,g("--offset-x",-100*o+"vw")},h=function(){const e=$("ul.item-list"),t=void 0===e.prop("isDislocate")||e.prop("isDislocate"),o=n.length;if(!0===t)for(let e=0;e<o;e++){const t=Math.floor(Math.random()*(e+1)),o=n[e];n[e]=n[t],n[t]=o}else{let e=n.slice();n.fill(null);for(let t=0;t<o;t++){const o=e[t],i=o.key;n[i+1]=o}e=null}e.prop("isDislocate",!t)},y=function(){const e=n[0].classList.contains("rotate180"),t=n.length;for(let o=0;o<t;o+=2){const t=n[o],i=n[o+1];n[o]=i,n[o+1]=t,e?(t.className="content-item posi-up",i.className="content-item posi-up"):(t.className="content-item rotate180 posi-down",i.className="content-item rotate180 posi-down")}},E=function(e){!1===(JSON.parse(localStorage.getItem(r))||!1)?-1===e?(e=t,o=t):e===t+1&&(e=0,o=0):e=o=d(0,t),localStorage.setItem(l,JSON.stringify(o)),g("--offset-x",-100*e+"vw")},S=function(e){$("#right-change-check").val(1),$("#left-change-check").val(1);let o=n[2*e+1];if(e!=t&&o){let e=o.querySelector(".img-origin"),t=o.querySelector(".img-core");e&&e.classList.remove("opacity"),t?.style.display&&(t.style.display=""),e=null,t=null}if(o=n[2*e],0!=e&&o){let e=o.querySelector(".img-origin"),t=o.querySelector(".img-core");e&&e.classList.remove("opacity"),t?.style.display&&(t.style.display=""),e=null,t=null}},k=function(e,t){const i=n["right"==e?2*o+1:2*o].querySelector(".img-core");if(!i)return A("%E5%BD%93%E5%89%8D%E6%97%A0%20core%20%E5%B1%82");""!=i.style.display?(i.style.display="",t.textContent=decodeURI("%E5%BD%93%E5%89%8D%E6%98%BE%E7%A4%BA%20core"),t.title=decodeURI("%E5%BD%93%E5%89%8D%E6%98%AF%E4%BB%85%E6%98%BE%E7%A4%BA%20core%20%E5%B1%82")):(i.style.display="none",t.textContent=decodeURI("%E5%BD%93%E5%89%8D%E9%9A%90%E8%97%8F%20core"),t.title=decodeURI("%E5%BD%93%E5%89%8D%E6%98%AF%E4%BB%85%E9%9A%90%E8%97%8F%20core%20%E5%B1%82"))},v=function(){const e=$(".dialog-info");if(0!==e.offset().top)return;const t=e?e[0].querySelector(".body"):null,o=t.children;for(let e=0;e<o.length;e++)t.removeChild(o[e]),e--;o.length=0;const n=0==e.offset().left?"left":"right";e.removeClass(n+"-show"),e.attr("show","0")},C=function(l,r,a){if(0==r.offset().top)return void v();const s=n["left"==l?2*o:2*o+1];if(-1===s.key&&0==o)return;if(s.key===e.length&&o==t)return;const d=JSON.parse(localStorage.getItem(c))||!1,g=e[s.key];let u=null;g.traitMaker&&(u=document.createElement("img"),u.src=i+g.traitMaker+".png",u.style=d?"transform: rotateZ(180deg);":"",a.appendChild(u));const p=document.createElement("p"),f=g.traitText.split("～～");p.innerText=f[0]+(d?f[2]:f[1]),a.appendChild(p),l="left"==l?"right":"left",r.addClass(l),r.attr("show","1"),requestAnimationFrame((()=>{requestAnimationFrame((()=>{r.addClass(l+"-show")}))}))},A=function(e,t=3){const o=$('<div class="message">'+decodeURI(e)+"</div>");$("body").append(o),requestAnimationFrame((()=>{o.addClass("show")}));let n=null;n=setTimeout((()=>{clearTimeout(n),n=null,n=setTimeout((()=>{clearTimeout(n),n=null,o.remove()}),100*t),o.removeClass("show")}),1e3*t)};$(document).ready((function(){f(),function(){const e=s()?"touchend":"click";$("li.right-arrow").bind(e,(()=>{v("left"),S(o),E(++o)})),$("li.left-arrow").bind(e,(()=>{v("right"),S(o),E(--o)}))}(),function(){const e=$(".dialog-setting"),t=$("#dislocate"),o=$("#rotate-180"),n=$("#random-page"),i=new Map,l="click";$(".settings").on(l,(()=>{const l=JSON.parse(localStorage.getItem(a))||!1,s=JSON.parse(localStorage.getItem(c))||!1,d=JSON.parse(localStorage.getItem(r))||!1;t.prop("checked",l),o.prop("checked",s),n.prop("checked",d),i.set(o,[s,y]),i.set(t,[l,h]),e.show()})),e.bind(l,(t=>{if(!t.target.classList.contains("dialog-setting"))return;let o=!1;for(const[e,t]of i){if(e.prop("checked")===t[0])continue;const n=t[1];"function"==typeof n&&n(),o=!0}o&&p(),i.clear(),e.hide()})),o.bind(l,(e=>{localStorage.setItem(c,JSON.stringify(e.target.checked))})),t.bind(l,(e=>{localStorage.setItem(a,JSON.stringify(e.target.checked))})),n.bind(l,(e=>{localStorage.setItem(r,JSON.stringify(e.target.checked))}))}(),function(){let e=null,i=null;const l=s()?"touchend":"mouseleave",r=$("#left-change-check"),a=$("#right-change-check"),c=function(l,r,a){if(null==e&&(e="left"==r?n[2*o]:n[2*o+1]),i||(i=e.querySelector(".img-origin")),o==t&&!i)return;if(0==o&&!i)return;!i.classList.contains("opacity")&&i.classList.add("opacity");const c=a||l.value;g("--img-opacity",1*c),curPage=o};a.on("input",(e=>{c(e.currentTarget,"right")})),a.on(l,(()=>{i&&i.classList.remove("opacity"),a.val(1),i=null,e=null})),r.on("input",(e=>{c(e.currentTarget,"left")})),r.on(l,(()=>{i&&i.classList.remove("opacity"),r.val(1),i=null,e=null})),$("body").bind("keydown",(e=>{49===e.originalEvent.keyCode?c(r,"left",.1):50===e.originalEvent.keyCode&&c(a,"right",.1)})),$("body").bind("keyup",(t=>{i&&i.classList.remove("opacity"),49===t.originalEvent.keyCode?r.val(1):50===t.originalEvent.keyCode&&a.val(1),i=null,e=null}))}(),function(){const e=s()?"touchend":"click",t=$("#right-mnemonic-analysis"),o=$("#left-mnemonic-analysis");$("#right-h-core").bind(e,(e=>k("right",t))),$("#left-h-core").bind(e,(e=>{k("left",o)})),$("body").bind("keyup",(e=>{39===e.originalEvent.keyCode?(e.preventDefault(),e.stopPropagation(),k("right",t)):37===e.originalEvent.keyCode&&(e.preventDefault(),e.stopPropagation(),k("left",o))}))}(),function(){const e=$(".dialog-info"),t=e?e[0].querySelector(".body"):null,o=s()?"touchend":"click";$("#right-mnemonic-analysis").bind(o,(()=>{C("right",e,t)})),$("#left-mnemonic-analysis").bind(o,(()=>{C("left",e,t)})),e.click(v),e.on("transitionend",(()=>{0==e.attr("show")&&(e.removeClass("left"),e.removeClass("right"))}))}(),s()||function(){const e=[33,38,219,189,188],t=[32,40,34,221,187,190],n=[37,38,39,40];$("body").bind("keydown",(e=>{const t=e.originalEvent.keyCode;n.indexOf(t)>=0&&(e.preventDefault(),e.stopPropagation())})),$("body").bind("keyup",(n=>{n.preventDefault(),n.stopPropagation();const i=n.originalEvent.keyCode;e.indexOf(i)>=0&&(v("right"),S(o),E(--o)),t.indexOf(i)>=0&&(v("left"),S(o),E(++o))}))}()}))}();
